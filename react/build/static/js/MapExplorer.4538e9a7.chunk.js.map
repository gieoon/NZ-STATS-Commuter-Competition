{"version":3,"sources":["../node_modules/fast-deep-equal/index.js","assets/help_white.svg","../../src/shared/uid.ts","../../src/web/Svg.tsx","../../src/web/ContentLoader.tsx","../../src/web/presets/FacebookStyle.tsx","components/loaders/mapVisualizer.jsx","components/destination.js","components/leftPanel.jsx","components/mapExplorer.jsx","../node_modules/classnames/index.js"],"names":["module","exports","equal","a","b","constructor","length","i","keys","Array","isArray","RegExp","source","flags","valueOf","Object","prototype","toString","hasOwnProperty","call","key","animate","backgroundColor","backgroundOpacity","baseUrl","children","foregroundColor","foregroundOpacity","gradientRatio","uniqueKey","interval","rtl","speed","style","title","fixedId","Math","random","substring","idClip","idGradient","idAria","rtlStyle","transform","keyTimes","dur","React.createElement","role","props","id","x","y","width","height","clipPath","fill","offset","stopColor","stopOpacity","attributeName","values","repeatCount","defaultProps","Svg","Facebook","viewBox","rx","cx","cy","r","MapVisualizerLoader","statistic","windowWidth","window","innerWidth","mapHeight","MAP_LEGEND_HEIGHT","COLORS","Destination","obj","type","map","index","Number","className","key2Display","SearchBar","lazy","LeftPanel","hoveredRegion","hoveredData","centroidData","highlightedData","destinationData","currentDestinationData","t","useTranslation","useState","MODES_OF_TRANSPORT","spring","useSpring","count","floor","COUNT","from","config","tension","clamp","duration","km","distance","HAVERSINE_DISTANCE","useEffect","to","fallback","classnames","DEPARTURE_NAME_1","departure_SA22018_V1_NAME","DESTINATION_NAME_1","destination_SA22018_V1_NAME","alignSelf","h1","interpolate","toFixed","COMMUTE_TYPE","replace","toLowerCase","charAt","toUpperCase","TYPE","src","help","alt","href","target","color","MapVisualizer","CommuteTab","React","memo","districtCode","educationData","workData","regionalEducationData","regionalWorkData","regionalTotalData","regionHighlighted","setRegionHighlighted","anchor","setAnchor","mapStatistic","setMapStatistic","isCountryLoaded","mapExplorerRef","useHistory","useRef","leafletMapRef","code","view","MAP_TYPES","COUNTRY","option","MAP_OPTIONS","TOTAL","currentMap","setCurrentMap","currentView","setCurrentView","undefined","setRegionalData","setHighlightedData","setCurrentDestinationData","hoveredDestination","setHoveredData","currentCommuteTypes","setCurrentCommuteTypes","updateCurrentData","educationMapData","WORK","workMapData","EDUCATION","data","setCurrentData","MAP_META","districtName","switchMap","useCallback","newMapMeta","mapType","STATE","districts","topDistrict","sort","getStatistic","ReactDOM","unstable_batchedUpdates","cityName","useMemo","hovered","produce","draft","name","CITY_NAMES","population_millions","DISTRICT_POPULATIONS_MIL","stickied","hidden","onClick","ref","current","clientWidth","changeMap","focused","handleTabClick","COMMUTE_PURPOSE_COLOUR","commuteType","prevProps","currProps","stateCode","NZ","meta","total","hasOwn","classNames","classes","arguments","arg","argType","push","inner","apply","join","default"],"mappings":"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","file":"static/js/MapExplorer.4538e9a7.chunk.js","sourcesContent":["'use strict';\n\n// do not edit .js files directly - edit src/index.jst\n\n\n\nmodule.exports = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    if (a.constructor !== b.constructor) return false;\n\n    var length, i, keys;\n    if (Array.isArray(a)) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;)\n        if (!equal(a[i], b[i])) return false;\n      return true;\n    }\n\n\n\n    if (a.constructor === RegExp) return a.source === b.source && a.flags === b.flags;\n    if (a.valueOf !== Object.prototype.valueOf) return a.valueOf() === b.valueOf();\n    if (a.toString !== Object.prototype.toString) return a.toString() === b.toString();\n\n    keys = Object.keys(a);\n    length = keys.length;\n    if (length !== Object.keys(b).length) return false;\n\n    for (i = length; i-- !== 0;)\n      if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      var key = keys[i];\n\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  }\n\n  // true if both NaN, false otherwise\n  return a!==a && b!==b;\n};\n","module.exports = __webpack_public_path__ + \"static/media/help_white.ecb08412.svg\";","export default (): string =>\n  Math.random()\n    .toString(36)\n    .substring(6)\n","import * as React from 'react'\n\nimport uid from '../shared/uid'\nimport { IContentLoaderProps } from './'\n\nconst SVG: React.FC<IContentLoaderProps> = ({\n  animate,\n  backgroundColor,\n  backgroundOpacity,\n  baseUrl,\n  children,\n  foregroundColor,\n  foregroundOpacity,\n  gradientRatio,\n  uniqueKey,\n  interval,\n  rtl,\n  speed,\n  style,\n  title,\n  ...props\n}) => {\n  const fixedId = uniqueKey || uid()\n  const idClip = `${fixedId}-diff`\n  const idGradient = `${fixedId}-animated-diff`\n  const idAria = `${fixedId}-aria`\n\n  const rtlStyle = rtl ? { transform: 'scaleX(-1)' } : null\n  const keyTimes = `0; ${interval}; 1`\n  const dur = `${speed}s`\n\n  return (\n    <svg\n      aria-labelledby={idAria}\n      role=\"img\"\n      style={{ ...style, ...rtlStyle }}\n      {...props}\n    >\n      {title ? <title id={idAria}>{title}</title> : null}\n      <rect\n        role=\"presentation\"\n        x=\"0\"\n        y=\"0\"\n        width=\"100%\"\n        height=\"100%\"\n        clipPath={`url(${baseUrl}#${idClip})`}\n        style={{ fill: `url(${baseUrl}#${idGradient})` }}\n      />\n\n      <defs role=\"presentation\">\n        <clipPath id={idClip}>{children}</clipPath>\n\n        <linearGradient id={idGradient}>\n          <stop\n            offset=\"0%\"\n            stopColor={backgroundColor}\n            stopOpacity={backgroundOpacity}\n          >\n            {animate && (\n              <animate\n                attributeName=\"offset\"\n                values={`${-gradientRatio}; ${-gradientRatio}; 1`}\n                keyTimes={keyTimes}\n                dur={dur}\n                repeatCount=\"indefinite\"\n              />\n            )}\n          </stop>\n\n          <stop\n            offset=\"50%\"\n            stopColor={foregroundColor}\n            stopOpacity={foregroundOpacity}\n          >\n            {animate && (\n              <animate\n                attributeName=\"offset\"\n                values={`${-gradientRatio / 2}; ${-gradientRatio / 2}; ${1 +\n                  gradientRatio / 2}`}\n                keyTimes={keyTimes}\n                dur={dur}\n                repeatCount=\"indefinite\"\n              />\n            )}\n          </stop>\n\n          <stop\n            offset=\"100%\"\n            stopColor={backgroundColor}\n            stopOpacity={backgroundOpacity}\n          >\n            {animate && (\n              <animate\n                attributeName=\"offset\"\n                values={`0; 0; ${1 + gradientRatio}`}\n                keyTimes={keyTimes}\n                dur={dur}\n                repeatCount=\"indefinite\"\n              />\n            )}\n          </stop>\n        </linearGradient>\n      </defs>\n    </svg>\n  )\n}\n\nSVG.defaultProps = {\n  animate: true,\n  backgroundColor: '#f5f6f7',\n  backgroundOpacity: 1,\n  baseUrl: '',\n  foregroundColor: '#eee',\n  foregroundOpacity: 1,\n  gradientRatio: 2,\n  id: null,\n  interval: 0.25,\n  rtl: false,\n  speed: 1.2,\n  style: {},\n  title: 'Loading...',\n}\n\nexport default SVG\n","import * as React from 'react'\n\nimport { Facebook, IContentLoaderProps } from '.'\nimport Svg from './Svg'\n\nconst ContentLoader: React.FC<IContentLoaderProps> = props =>\n  props.children ? <Svg {...props} /> : <Facebook {...props} />\n\nexport default ContentLoader\n","import * as React from 'react'\n\nimport { IContentLoaderProps } from '..'\nimport ContentLoader from '../ContentLoader'\n\nconst ReactContentLoaderFacebook: React.FC<IContentLoaderProps> = props => (\n  <ContentLoader viewBox=\"0 0 476 124\" {...props}>\n    <rect x=\"48\" y=\"8\" width=\"88\" height=\"6\" rx=\"3\" />\n    <rect x=\"48\" y=\"26\" width=\"52\" height=\"6\" rx=\"3\" />\n    <rect x=\"0\" y=\"56\" width=\"410\" height=\"6\" rx=\"3\" />\n    <rect x=\"0\" y=\"72\" width=\"380\" height=\"6\" rx=\"3\" />\n    <rect x=\"0\" y=\"88\" width=\"178\" height=\"6\" rx=\"3\" />\n    <circle cx=\"20\" cy=\"20\" r=\"20\" />\n  </ContentLoader>\n)\n\nexport default ReactContentLoaderFacebook\n","import { COLORS, MAP_LEGEND_HEIGHT } from \"../../constants\";\n\nimport React from \"react\";\nimport ContentLoader from \"react-content-loader\";\n\n// Margins as declared in CSS\nexport const MAP_BUFFER_MARGINS = 42;\nexport const INDIA_ASPECT_RATIO = 0.885;\n\nconst MapVisualizerLoader = ({ width, statistic }) => {\n  const windowWidth = window.innerWidth;\n  // Default width for loader\n  if (!width) width = windowWidth > 769 ? 480 : windowWidth;\n  // From CSS\n  const scalingFactor = windowWidth > 769 ? 0.9 : 1;\n  const mapHeight = (scalingFactor * width) / INDIA_ASPECT_RATIO;\n  const height = MAP_BUFFER_MARGINS + MAP_LEGEND_HEIGHT + mapHeight;\n  return (\n    <ContentLoader\n      viewBox={`0 0 ${width} ${height}`}\n      height={height}\n      width={width}\n      speed={2}\n      backgroundColor={COLORS[statistic]}\n    >\n      <circle cx={0.4 * width} cy={height / 2} r=\"5\" />\n      <circle cx={0.5 * width} cy={height / 2} r=\"5\" />\n      <circle cx={0.6 * width} cy={height / 2} r=\"5\" />\n    </ContentLoader>\n  );\n};\n\nexport default MapVisualizerLoader;\n","import React from 'react'\nimport {useSprings, animated} from 'react-spring';\n\nfunction Destination({\n    obj,\n    type,\n}){\n    // console.log(\"destination obj: \", obj)\n\n    // const arr = \n    // const springs = useSprings(\n\n    // )\n\n    return(\n        <div>\n            {\n                Object.keys(obj || {}).map((key,index) => (\n                    Number(obj[key]) \n                    ? <p key={type + \"-\" + index} className=\"destination-txt\">{key2Display(key) + \": \" + obj[key]}</p>\n                    : \"\"\n                ))\n            }\n        </div>\n    )\n}\n\nfunction key2Display(key){\n    switch(key){\n        case \"average_distance_of_arriving_commute\": return \"Average distance of arriving commutes\";\n        case \"average_distance_of_departing_commute\": return \"Average distance of departing commutes\"; \n        case \"bicycle_distance\": return \"Average distance travelled by bicycle\";\n        case \"bus_distance\": return \"Average distance travelled by bus\";\n        case \"common_arrival_1\": return \"Most common destination for commutes from\";\n        case \"common_arrival_2\": return \"Second most common destination for commutes from\";\n        case \"common_arrival_3\": return \"Third most common destination for commutes from\";\n        case \"common_destination_1\": return \"Most common destination departing from here\";\n        case \"common_destination_2\": return \"Second most common destination departing from here\";\n        case \"common_destination_3\": return \"Third most common destination departing from here\";\n        case \"education_bicycle_count\": return \"Number of commutes to school by bike\";\n        case \"education_bus_count\": return \"Number of commutes to school by bus\"\n        case \"education_ferry_count\": return \"Number of commutes to school by ferry\"\n        case \"education_home_count\": return \"Studying at home\"\n        case \"education_other_count\": return \"Number of commutes to school by other means\";\n        case \"education_own_vehicle_count\": return \"Number of commutes to school using own vehicle\"\n        case \"education_passenger_count\": return \"Number of commutes to school as a passenger in a vehicle\"\n        case \"education_train_count\": return \"Number of commutes to school by train\"\n        case \"education_walk_or_jog_count\": return \"Number of commutes to school walking/jogging\"\n        case \"ferry_distance\": return \"Average commute distance by ferry\";\n        case \"home_distance\":  return \"Distance commuted from home\";\n        case \"number_of_commutes_arriving\": return \"Number of commutes arriving here\"\n        case \"number_of_commutes_departing\": return \"Number of commutes departing from here\"\n        case \"number_of_people_commuting\": return \"Number of people commuting from/to this destination\";\n        case \"other_distance\": return \"Average commute distance using other means\";\n        case \"own_vehicle_distance\": return \"Average commute distance commuting using own vehicle\";\n        case \"passenger_distance\": return \"Average commute distance commuting as a passenger in a vehicle\";\n        case \"total_bicycle_count\": return \"Number of commutes by bicycle\";\n        case \"total_bus_count\": return \"Number of commutes by bus\";\n        case \"total_ferry_count\": return \"Number of commutes by ferry\";\n        case \"total_home_count\": return \"Number of people working/studying from home\";\n        case \"total_other_count\": return \"Number of commutes by other means\";\n        case \"total_own_vehicle_count\": return \"Number of commutes using own vehicle\";\n        case \"total_passenger_count\": return \"Number of commutes as a passenger\";\n        case \"total_train_count\": return \"Number of commutes using train\";\n        case \"total_walk_or_jog_count\": return \"Number of commutes walking or jogging\"\n        case \"train_distance\": return \"Average commute distance using train\"\n        case \"walk_or_jog_distance\": return \"Average commute distance walking or jogging\"\n        case \"work_bicycle_count\": return \"Number of commutes to work by bicycle \"\n        case \"work_bus_count\": return \"Number of commutes to work by bus\"\n        case \"work_ferry_count\": return \"Number of commutes to work by ferry\"\n        case \"work_home_count\": return \"Working from home\"\n        case \"work_other_count\": return \"Number of commutes to work by other means\"\n        case \"work_own_vehicle_count\": return \"Number of commutes to work using own vehicle\";\n        case \"work_passenger_count\": return \"Number of commutes to work as passenger\"\n        case \"work_train_count\": return \"Number of commutes to work by train\"\n        case \"work_walk_or_jog_count\": return \"Number of commutes to work walking/jogging\";\n        default : return \"\";\n    }\n}\n\nfunction key2HelpDescription(key){\n    switch(key){\n        default: return \"\"\n    }\n}\n\nexport default Destination;","import React, {useState, lazy, Suspense} from 'react';\nimport {Link} from 'react-router-dom';\nimport './leftPanel.scss';\nimport classnames from \"classnames\";\nimport { useTranslation } from \"react-i18next\";\nimport { useSprings, useSpring, animated } from \"react-spring\";\nimport help from '../assets/help_white.svg';\nimport Destination from './destination.js';\n\nimport {\n    MAP_OPTIONS,\n    MODES_OF_TRANSPORT,\n} from '../constants'\nimport {\n    formatNumber, \n    capitalize,\n    getStatistic,\n} from '../utils/commonFunctions'\nimport { useEffect } from 'react';\n\nconst SearchBar = lazy(() => import('./searchbar'));\n\nfunction LeftPanel({\n    hoveredRegion,\n    hoveredData,\n    highlightedData,\n    centroidData,\n    destinationData,\n    currentDestinationData\n}){\n    // console.log(destinationData)\n    const { t } = useTranslation();\n\n    const [currentMapStatistics, setCurrentMapStatistics] = useState(MODES_OF_TRANSPORT);\n\n    const [currentCommuteType, setCurrentCommuteType] = useState(\"Total\");\n    \n    const spring = useSpring({\n      // This is the default to: value\n      // count: Math.floor(Math.random() * 100),\n      count: Math.floor(hoveredData.hoveredData.COUNT) || 0,\n      from: {\n          count: Math.floor(hoveredData.hoveredData.COUNT) || 0,\n      },\n      config: {\n        tension: 500,\n        clamp: true,\n        duration: 350,\n      }\n    })\n\n    // console.log(Math.floor(hoveredData.hoveredData.HAVERSINE_DISTANCE))\n    const km = useSpring({\n      distance: Math.floor(hoveredData.hoveredData.HAVERSINE_DISTANCE) || 0,\n      from: {\n        distance: Math.floor(hoveredData.hoveredData.HAVERSINE_DISTANCE) || 0,\n      },\n      config: {\n        tension: 500,\n        clamp: true,\n        duration: 350,\n      }\n    })\n\n    useEffect(()=>{\n      // console.log('currentDestinationData updated: ', currentDestinationData);\n      // console.log(destinationData);\n    }, [currentDestinationData])\n    \n    return(\n        <div className=\"LeftPanel\">\n            <div className=\"title\"> \n                <Link to=\"/\">\n                    Commute\n                    <span> New Zealand</span>\n                </Link>\n            </div>\n\n            <Suspense fallback={<div></div>}>\n                <SearchBar \n                  centroidData={centroidData}\n                />\n            </Suspense>\n\n            <div className=\"meta\">\n            <h2 className={classnames(\"total\")}>\n\n              <div>\n                {t(\"From \")}\n                {/* {t(hoveredRegion.name)} */}\n                {hoveredData.hoveredData.DEPARTURE_NAME_1}\n                {hoveredData.hoveredData.departure_SA22018_V1_NAME && hoveredData.hoveredData.departure_SA22018_V1_NAME.length ? \", \" : \"\"}\n                {t(hoveredData.hoveredData.departure_SA22018_V1_NAME)}\n                <div>\n                  {t(\"To \")}\n                  {hoveredData.hoveredData.DESTINATION_NAME_1}\n                  {/* {hoveredData.hoveredDestination} */}\n                  { hoveredData.hoveredData.DESTINATION_NAME_1 //Or, use DESTINATION_NAME_2\n                  //hoveredData.hoveredDestination.length \n                    ? \", \"\n                    : \"\"  \n                  }\n                  {hoveredData.hoveredData.destination_SA22018_V1_NAME}\n                </div>\n\n                <Destination \n                  obj={destinationData[currentDestinationData.from]}\n                  type=\"from\"\n                />\n                <Destination \n                  obj={destinationData[currentDestinationData.to]}\n                  type=\"to\"\n                />\n              </div>\n              \n              <div style={{alignSelf: \"center\"}}>\n                {/* {!isNaN(Number(hoveredData.hoveredData.HAVERSINE_DISTANCE))\n                  ? Number(hoveredData.hoveredData.HAVERSINE_DISTANCE).toFixed(2) + \"km\"\n                  : \"\"\n                } */}\n                <animated.h1>\n                  {km.distance.interpolate((distance) => \n                        // !isNaN(distance) ? distance.toFixed(2) + \"km\" : \"\"\n                        distance.toFixed(2).toString() + \"km\"\n                  )}\n                </animated.h1>\n              </div>\n            </h2>\n          </div>\n          <div className=\"map-stats\">\n            <div\n                  // key={statistic}\n                  // className={classnames(\"stats\", statistic, {\n                  //   focused: statistic === currentCommuteType,\n                  // })}\n                  // onClick={() => clickedCommuteType(statistic)}\n                >\n              {/* <h5>{t(capitalize(statistic))}</h5> */}\n              <div className=\"stats-bottom\">\n                {(hoveredData.hoveredData.COMMUTE_TYPE || \"\")\n                  .replace(/[_]/g,' ')\n                  .toLowerCase()\n                  .charAt(0)\n                  .toUpperCase()\n                  + \n                  (hoveredData.hoveredData.COMMUTE_TYPE || \"\")\n                    .replace(/[_]/g,' ')\n                    .substring(1)\n                    .toLowerCase()\n                }\n                <animated.h1>\n                  {/* {spring.count.interpolate((count) => \n                    formatNumber(Math.floor(count))\n                  )} */}\n                  {spring.count.interpolate((count) => \n                      count > 0\n                      ? Math.floor(count).toFixed() + \" people\"//\" commutes\"\n                      : \"\"\n                  )\n                  // {spring.count \n                  // ? spring.count + \" Commute\"\n                  // : \"\"\n                  }\n                </animated.h1>\n                <h2>\n                  {\n                    hoveredData.hoveredData.TYPE \n                    ? \"Commuting for \"\n                    : \"\"\n                  }\n                  {(hoveredData.hoveredData.TYPE || \"\")\n                    .charAt(0)\n                  + (hoveredData.hoveredData.TYPE || \"\")\n                    .substring(1)\n                    .toLowerCase()\n                  }\n                </h2>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"about-wrapper\">\n            <Link to=\"/about\">\n              <img src={help} alt=\"\" />\n            </Link>\n          \n            <h6 className={classnames(\"footnote\")}>\n              &dagger; {`${t(\"Based on 2018 Census by NZ Statistics, see \")}`}\n              <a\n                  href=\"https://datafinder.stats.govt.nz/data/category/census/2018/commuter-view/?_ga=2.217129552.794612537.1592401476-705599149.1592401476\"\n                  target=\"_noblank\"\n                  style={{ color: \"#6c757d\" }}\n              >\n                  {t(\"source\")}\n              </a>\n              <br/>\n              {t(\"Locations have been approximated to protect user privacy\")}\n            </h6>\n          </div>\n        </div>\n    )\n}\n\nexport default LeftPanel;\n\n/*\n<div>{currentMapStatistics.map((statistic, index) => (\n  <div\n    key={statistic}\n    className={classnames(\"stats\", statistic, {\n      focused: statistic === currentCommuteType,\n    })}\n    onClick={() => clickedCommuteType(statistic)}\n  >\n    <h5>{t(capitalize(statistic))}</h5>\n    <div className=\"stats-bottom\">\n      {hoveredData.hoveredData.COMMUTE_TYPE}\n      <animated.h1>\n        {springs[index].total.interpolate((total) =>\n          formatNumber(Math.floor(total))\n        )}\n        {spring.count.interpolate((count) => \n          formatNumber(Math.floor(count))\n        )}\n      </animated.h1>\n    </div>\n  </div>\n))}\n</div>\n*/","import MapVisualizerLoader from \"./loaders/mapVisualizer\";\n\nimport {\n  MAP_META,\n  MAP_OPTIONS,\n  MODES_OF_TRANSPORT,\n  DISTRICT_STATISTICS_TOTAL,\n  DISTRICT_STATISTICS_WORK,\n  DISTRICT_STATISTICS_EDUCATION,\n  DISTRICT_SUMMARY,\n  COMMUTE_PURPOSE_COLOUR,\n  CENTROID_SUMMARY,\n  MAP_TYPES,\n  CITY_NAMES,\n  UNKNOWN_DISTRICT_KEY,\n  DISTRICT_POPULATIONS_MIL,\n} from \"../constants\";\nimport {\n  capitalize,\n  formatNumber,\n  formatDate,\n  formatLastUpdated,\n  getStatistic,\n} from \"../utils/commonFunctions\";\n\nimport { PinIcon } from \"@primer/octicons-v2-react\";\nimport classnames from \"classnames\";\nimport equal from \"fast-deep-equal\";\nimport produce from \"immer\";\nimport React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n  Suspense,\n  lazy,\n} from \"react\";\nimport ReactDOM from \"react-dom\";\nimport * as Icon from \"react-feather\";\nimport { useTranslation } from \"react-i18next\";\nimport { useHistory } from \"react-router-dom\";\nimport { useSprings, animated } from \"react-spring\";\nimport LeftPanel from \"./leftPanel\";\nimport { differenceInSeconds } from \"date-fns/esm\";\n\nconst MapVisualizer = lazy(() =>\n  import(\"./mapVisualizer\" /* webpackChunkName: \"MapVisualizer\" */)\n);\n\nconst CommuteTab = lazy(() => \n  import(\"./commuteTab\" /* webpackChunkName: \"CommuteTab\" */)\n)\n\nfunction MapExplorer({\n  districtCode,\n  educationData,\n  workData,\n  regionalEducationData,\n  regionalWorkData,\n  regionalTotalData,\n  centroidData,\n  destinationData,\n  regionHighlighted,\n  setRegionHighlighted,\n  anchor,\n  setAnchor,\n  mapStatistic,\n  setMapStatistic,\n  isCountryLoaded = true,\n}) {\n  const { t } = useTranslation();\n  const history = useHistory();\n\n  const mapExplorerRef = useRef();\n  const leafletMapRef = useRef();\n\n  const [currentMap, setCurrentMap] = useState({\n    code: districtCode,\n    view: MAP_TYPES.COUNTRY,\n    option: MAP_OPTIONS.TOTAL\n  });\n\n  // District vs Country view\n  const [currentView, setCurrentView] = useState({\n    view: MAP_TYPES.COUNTRY\n  }); \n  \n  const [regionalData, setRegionalData] = useState(\n    undefined\n  )\n\n  const [highlightedData, setHighlightedData] = useState({});\n\n  const [currentDestinationData, setCurrentDestinationData] = useState({\n    from: \"\",\n    to: \"\",\n  })\n\n  // What to display at the top\n  const [currentMapStatistics, setCurrentMapStatistics] = useState(MODES_OF_TRANSPORT);\n// console.log(currentMapStatistics)\n  const [hoveredData, setHoveredData] = useState({\n    hoveredData: {},\n    hoveredDestination: \"\",\n  })\n\n  const [currentCommuteTypes, setCurrentCommuteTypes] = useState(\n    // Object.values(MODES_OF_TRANSPORT) // Select all\n    [\n      \"Drive own vehicle\"\n    ]\n  )\n\n  // const setCurrentCommuteTypes = (e) => {\n    // console.log('setCurrentCommuteTypes: ', currentCommuteTypes);\n    // console.log(leafletMapRef);\n    // leafletMapRef.current.updateData();\n  // }\n\n  // useEffect(()=>{\n  //   console.log('current commute types changed: ', currentCommuteTypes)\n  // })\n\n  const updateCurrentData = () => {\n    // console.log(currentMap.option);\n    return {\n      educationMapData: \n        currentMap.option !== MAP_OPTIONS.WORK\n        ? educationData\n        : [],\n      workMapData: \n        currentMap.option !== MAP_OPTIONS.EDUCATION\n        ? workData\n        : []\n    }\n  }\n  // Define data based on the current tab.\n  const [data, setCurrentData] = useState(updateCurrentData);\n\n  const currentMapMeta = MAP_META[currentMap.code];\n\n  // Executes after a state update\n  useEffect(() => {\n    setCurrentData(updateCurrentData);\n    // console.log(\"currentMap.option: \", currentMap.option);\n    setCurrentMap({\n      code: regionHighlighted.districtCode,\n      view: MAP_TYPES.COUNTRY,\n      option: currentMap.option,\n    });\n    // if (regionHighlighted.cityName) {\n    //   if (\n    //     currentMap.code !== regionHighlighted.districtCode &&\n    //     !(\n    //       currentMapMeta.mapType === MAP_TYPES.COUNTRY &&\n    //       currentMap.view === MAP_TYPES.COUNTRY\n    //     )\n    //   ) {\n    //     const newMapMeta = MAP_META[regionHighlighted.districtCode];\n    //     if (!newMapMeta) {\n    //       return;\n    //     }\n    //     // setCurrentMap({\n    //     //   code: regionHighlighted.districtCode,\n    //     //   view: MAP_TYPES.COUNTRY,\n    //     //   option: currentMap.option,\n    //     // });\n    //   }\n    // } else if (isCountryLoaded && currentMapMeta.mapType === MAP_TYPES.COUNTRY) {\n    //   // setCurrentMap({\n    //   //   code: \"NZ\",\n    //   //   view: MAP_TYPES.COUNTRY,\n    //   //   option: currentMap.option,\n    //   // });\n    // }\n  }, [\n    isCountryLoaded,\n    regionHighlighted.districtCode,\n    regionHighlighted.districtName,\n    currentMap.code,\n    currentMap.option,\n    currentMap.view,\n    // currentMapMeta.mapType,\n  ]);\n\n  const switchMap = useCallback(\n    (districtCode) => {\n      const newMapMeta = MAP_META[districtCode];\n      if (!newMapMeta) {\n        return;\n      }\n      if (newMapMeta.mapType === MAP_TYPES.STATE) {\n        const districts = educationData[districtCode].districts || {};\n        const topDistrict = Object.keys(districts).sort(\n          (a, b) =>\n            getStatistic(districts[b], \"total\", mapStatistic) -\n            getStatistic(districts[a], \"total\", mapStatistic)\n        )[0];\n        ReactDOM.unstable_batchedUpdates(() => {\n          setRegionHighlighted({\n            districtCode: districtCode,\n            cityName: topDistrict,\n          });\n          setCurrentMap({\n            code: districtCode,\n            view: MAP_TYPES.COUNTRY,\n            option: currentMap.option,\n          });\n        });\n      } else {\n        ReactDOM.unstable_batchedUpdates(() => {\n          setCurrentMap({\n            code: \"NZ\",\n            view: MAP_TYPES.COUNTRY,\n            option: currentMap.option,\n          });\n          setRegionHighlighted({\n            districtCode: \"NZ\",\n            cityName: null,\n          });\n        });\n      }\n    },\n    [educationData, workData, currentMap.option, mapStatistic, setRegionHighlighted]\n  );\n\n  useEffect(() => {\n    switchMap(districtCode);\n  }, [districtCode, switchMap]);\n\n  // Set the values to be used at the top.\n  // const panelState = useState({\n  //   data: hoveredData.hoveredData\n  // },[data]);\n  /*() => {\n    return produce(data, (draft) => {\n      draft.district = regionHighlighted.districtCode;\n    });\n  }, [\n    data,\n    regionHighlighted.districtCode,\n    currentMap.view,\n    currentMap.code,\n  ]);\n  */\n  // console.log(panelState);\n\n  const hoveredRegion = useMemo(() => {\n    // console.log(hoveredData);\n    const hovered =\n      (regionHighlighted.districtCode\n        ? educationData[regionHighlighted.districtCode]?.districts?.[\n            regionHighlighted.cityName\n          ]\n        : educationData[regionHighlighted.districtCode]) || {};\n    return produce(hovered, (draft) => {\n      draft.name =\n        regionHighlighted.districtCode ||\n        CITY_NAMES[regionHighlighted.districtCode];\n      if (!regionHighlighted.districtCode)\n        draft.population_millions =\n          DISTRICT_POPULATIONS_MIL[regionHighlighted.districtCode];\n    });\n  }, [\n    educationData,\n    workData,\n    regionHighlighted.districtCode,\n    regionHighlighted.cityName,\n  ]);\n\n  const handleTabClick = (option) => {\n    // console.log('moving to tab: ', option);\n    setCurrentMap({\n      code: currentMap.code,\n      view: MAP_TYPES.COUNTRY,\n      option: option,\n    });\n    if (currentView.view === MAP_TYPES.COUNTRY)\n      setRegionHighlighted({\n        districtCode: regionHighlighted.districtCode,\n        cityName: null,\n      });\n    return;\n  };\n\n  return (\n    <div\n      className={classnames(\n        \"MapExplorer\",\n        { stickied: anchor === \"mapexplorer\" },\n        { hidden: anchor && anchor !== \"mapexplorer\" }\n      )}\n    >\n      {window.innerWidth > 769 && (\n        <div\n          className={classnames(\"anchor\", {\n            stickied: anchor === \"mapexplorer\",\n          })}\n          onClick={() => {\n            setAnchor(anchor === \"mapexplorer\" ? null : \"mapexplorer\");\n          }}\n        >\n          {/* <PinIcon /> */}\n        </div>\n      )}\n\n      {/* <div className=\"header\">\n        { currentView.view === MAP_TYPES.COUNTRY \n          ? <h6>\n            {t(\"{{action}} over a {{mapType}} for more details\", {\n              action: t(window.innerWidth <= 769 ? \"Tap\" : \"Hover\"),\n              mapType: t(\"Regional District\"),\n            })}\n          </h6>\n          : \"\"\n        }\n      </div> */}\n\n      {/* <LeftPanel \n        hoveredRegion={hoveredRegion}\n        hoveredData={hoveredData}\n        highlightedData={highlightedData}\n      /> */}\n      \n      {/* <div className=\"details-container-wrapper\">\n        <div className=\"details-container\">\n          <div className=\"meta\">\n            <h2\n              className={classnames(mapStatistic, {\n                [hoveredRegion?.zone]: currentMap.option === MAP_OPTIONS.HOTSPOTS,\n              })}\n            >\n              <div>\n                {t(\"From \")}\n                {t(hoveredRegion.name)}\n                {hoveredData.hoveredData.departure_SA22018_V1_NAME && hoveredData.hoveredData.departure_SA22018_V1_NAME.length ? \", \" : \"\"}\n                {t(hoveredData.hoveredData.departure_SA22018_V1_NAME)}\n                <div>\n                  {t(\"To \")}\n                  {hoveredData.hoveredDestination}\n                  {hoveredData.hoveredDestination.length \n                    ? \", \"\n                    : \"\"  \n                  }\n                  {hoveredData.hoveredData.destination_SA22018_V1_NAME}\n                </div>\n              </div>\n              \n              <div style={{alignSelf: \"center\"}}>\n                {!isNaN(Number(hoveredData.hoveredData.HAVERSINE_DISTANCE))\n                  ? Number(hoveredData.hoveredData.HAVERSINE_DISTANCE).toFixed(2) + \"km\"\n                  : \"\"\n                }\n              </div>\n            </h2>\n          </div>\n          <div className=\"map-stats\">\n            <div>\n              {Object.keys(highlightedData || {}).map((statistic, index) => (\n                <div key={index}>\n                  {statistic}\n                  ,\n                  {highlightedData[statistic]}\n                </div>\n                )\n              )\n              }\n            </div>\n            : <div>{currentMapStatistics.map((statistic, index) => (\n                <div\n                  key={statistic}\n                  className={classnames(\"stats\", statistic, {\n                    focused: statistic === mapStatistic,\n                  })}\n                  onClick={() => setMapStatistic(statistic)}\n                >\n                  <h5>{t(capitalize(statistic))}</h5>\n                  <div className=\"stats-bottom\">\n                    <animated.h1>\n                      {springs[index].total.interpolate((total) =>\n                        formatNumber(Math.floor(total))\n                      )}\n                    </animated.h1>\n                  </div>\n                </div>\n              ))}\n            </div>\n            }\n            \n          </div>\n        </div>\n      </div> */}\n\n      <div ref={mapExplorerRef}>\n        {mapStatistic && (\n          <Suspense\n            fallback={\n              <MapVisualizerLoader\n                className=\"map-loader\"\n                {...{\n                  width: mapExplorerRef.current?.clientWidth,\n                  statistic: mapStatistic, // the color to set for the loader\n                }}\n              />\n            }\n          >\n            <div className=\"main-wrapper\">\n              <LeftPanel \n                hoveredRegion={hoveredRegion}\n                hoveredData={hoveredData}\n                highlightedData={highlightedData}\n                centroidData={centroidData}\n                destinationData={destinationData}\n                currentDestinationData={currentDestinationData}\n              />\n\n              <div className=\"map-wrapper\">\n\n                <MapVisualizer\n                  currentMap={currentMap}\n                  data={data}\n                  regionalEducationData={regionalEducationData}\n                  regionalWorkData={regionalWorkData}\n                  regionalTotalData={regionalTotalData}\n                  centroidData={centroidData}\n                  setRegionalData={setRegionalData}\n                  currentView={currentView}\n                  setCurrentView={setCurrentView}\n                  changeMap={switchMap}\n                  regionHighlighted={regionHighlighted}\n                  setRegionHighlighted={setRegionHighlighted}\n                  setHighlightedData={setHighlightedData}\n                  setHoveredData={setHoveredData}\n                  statistic={mapStatistic}\n                  isCountryLoaded={isCountryLoaded}\n                  currentCommuteTypes={currentCommuteTypes}\n                  leafletMapRef={leafletMapRef}\n                  setCurrentDestinationData={setCurrentDestinationData}\n                />\n\n                <div className=\"tabs-container\">\n                  <div className=\"tabs-map\">\n                    {Object.values(MAP_OPTIONS).map((option) => (\n                      <div\n                        key={option}\n                        className={classnames(\"tab\", {\n                          focused: currentMap.option === option,\n                        })}\n                        onClick={() => handleTabClick(option)}\n                      >\n                        <h4 className={option}\n                          style={{\n                            color: COMMUTE_PURPOSE_COLOUR[option.toUpperCase()],\n                          }}\n                        >\n                          {t(option)}\n                          {/* {option === MAP_OPTIONS.EDUCATION && <sup>&dagger;</sup>} */}\n                        </h4>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n\n                {/* <div className=\"info legend\">\n                {\n                  Object.keys(COMMUTE_PURPOSE_COLOUR).map((commutePurpose, index) => (\n                    <div key={index}>\n                      <i style={{\"background\": COMMUTE_PURPOSE_COLOUR[commutePurpose]}}></i>\n                      <span>{ commutePurpose }</span>\n                    </div>\n                  ))\n                }\n                </div> */}\n\n              </div>\n\n              <div className=\"commutes-wrapper\">\n                {Object.values(MODES_OF_TRANSPORT).map((commuteType, i)=>(\n                    <CommuteTab \n                      commuteType={commuteType} \n                      currentCommuteTypes={currentCommuteTypes}\n                      setCurrentCommuteTypes={setCurrentCommuteTypes}\n                      key={i} \n                    />\n                  ))\n                }\n              </div>\n\n            </div>\n\n          </Suspense>\n        )}\n      </div>\n    </div>\n  );\n}\n\nconst isEqual = (prevProps, currProps) => {\n  if (!equal(prevProps.stateCode, currProps.stateCode)) {\n    return false;\n  } else if (!equal(prevProps.regionHighlighted, currProps.regionHighlighted)) {\n    return false;\n  } else if (!equal(prevProps.mapStatistic, currProps.mapStatistic)) {\n    return false;\n  } else if (!equal(prevProps.anchor, currProps.anchor)) {\n    return false;\n  } else if (\n    !equal(\n      prevProps.educationData?.NZ?.meta?.[\"last_updated\"],\n      currProps.educationData?.NZ?.meta?.[\"last_updated\"]\n    )\n  ) {\n    return false;\n  } else if (\n    !equal(\n      prevProps.educationData?.NZ?.total,\n      currProps.educationData?.NZ?.total\n    )\n  ) {\n    return false;\n  }\n  return true;\n};\n\nexport default React.memo(MapExplorer, isEqual);\n","/*!\n  Copyright (c) 2017 Jed Watson.\n  Licensed under the MIT License (MIT), see\n  http://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\n\tfunction classNames () {\n\t\tvar classes = [];\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (!arg) continue;\n\n\t\t\tvar argType = typeof arg;\n\n\t\t\tif (argType === 'string' || argType === 'number') {\n\t\t\t\tclasses.push(arg);\n\t\t\t} else if (Array.isArray(arg) && arg.length) {\n\t\t\t\tvar inner = classNames.apply(null, arg);\n\t\t\t\tif (inner) {\n\t\t\t\t\tclasses.push(inner);\n\t\t\t\t}\n\t\t\t} else if (argType === 'object') {\n\t\t\t\tfor (var key in arg) {\n\t\t\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\t\t\tclasses.push(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn classes.join(' ');\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tclassNames.default = classNames;\n\t\tmodule.exports = classNames;\n\t} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\tdefine('classnames', [], function () {\n\t\t\treturn classNames;\n\t\t});\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n"],"sourceRoot":""}